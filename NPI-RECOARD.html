<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPI Record - Multi-User Version</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature_pad.min.js"></script>
    <!-- Thêm Axios cho API calls -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #000;
            line-height: 1.2;
            padding: 10px;
            margin: 0;
            font-size: 11px;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .form-content {
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 15px;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
        }
        
        .header h1 {
            color: #000;
            margin-bottom: 5px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .form-section {
            margin-bottom: 20px;
            border: 1px solid #000;
            border-radius: 2px;
            padding: 10px;
            background-color: #fff;
            page-break-inside: avoid;
        }
        
        .section-title {
            background-color: #e0e0e0;
            color: #000;
            padding: 8px 10px;
            margin: -10px -10px 10px -10px;
            border-bottom: 1px solid #000;
            font-size: 14px;
            font-weight: bold;
        }
        
        .sub-section-title {
            background-color: #f0f0f0;
            color: #000;
            padding: 6px 8px;
            margin: 10px -10px;
            border-top: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            font-size: 13px;
            font-weight: bold;
        }
        
        .form-row {
            display: flex;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .form-group {
            flex: 1;
            min-width: 180px;
            margin-bottom: 8px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #000;
            font-size: 11px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 5px 8px;
            border: 1px solid #999;
            border-radius: 3px;
            font-size: 11px;
            background-color: white;
        }
        
        .form-group textarea {
            min-height: 70px;
            resize: vertical;
            overflow-y: auto;
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 8px;
            padding: 8px 0;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
        }
        
        .checkbox-item input {
            margin-right: 6px;
        }
        
        .signature-container {
            border: 1px solid #999;
            border-radius: 3px;
            padding: 8px;
            margin-top: 8px;
            background-color: white;
        }
        
        .signature-pad {
            border: 1px solid #ccc;
            border-radius: 3px;
            width: 100%;
            height: 120px;
            cursor: crosshair;
        }
        
        .signature-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .signature-controls button {
            padding: 6px 12px;
            background-color: #4a6fa5;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .signature-controls button:hover {
            background-color: #3a5a8a;
        }
        
        .signature-display {
            height: 80px;
            border: 1px dashed #999;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-style: italic;
            background-color: #f9f9f9;
        }
        
        .signature-display img {
            max-width: 100%;
            max-height: 100%;
        }
        
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
            position: sticky;
            top: 10px;
            z-index: 100;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            min-width: 160px;
        }
        
        .btn-primary {
            background-color: #4a6fa5;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #3a5a8a;
        }
        
        .btn-success {
            background-color: #2e7d32;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #1b5e20;
        }
        
        .btn-danger {
            background-color: #c62828;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #b71c1c;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            margin-bottom: 15px;
            font-size: 11px;
            table-layout: fixed;
        }
        
        th, td {
            border: 1px solid #000;
            padding: 6px;
            text-align: left;
            vertical-align: top;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        th {
            background-color: #f0f0f0;
            font-weight: bold;
            text-align: center;
        }
        
        td.long-content-cell {
            min-height: 60px;
            height: auto;
        }
        
        .note {
            font-size: 10px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 11px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            body {
                padding: 0;
                margin: 0;
                background-color: white;
                font-size: 10pt;
            }
            
            .container {
                box-shadow: none;
                padding: 0;
                margin: 0;
                width: 100%;
            }
            
            .form-content {
                padding: 15mm;
            }
            
            .signature-display {
                border: 1px solid #000;
            }
            
            .buttons-container {
                display: none;
            }
            
            .form-section {
                page-break-inside: avoid;
                break-inside: avoid;
            }
            
            table {
                page-break-inside: auto;
            }
            
            tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
            
            td, th {
                page-break-inside: avoid;
                page-break-after: auto;
            }
            
            td {
                overflow: visible !important;
                height: auto !important;
                max-height: none !important;
            }
        }
        
        .input-small {
            width: 100px;
            display: inline-block;
        }
        
        .input-medium {
            width: 180px;
            display: inline-block;
        }
        
        .form-group.full-width {
            flex: 0 0 100%;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .form-value {
            min-height: 20px;
            padding: 3px 5px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            border-radius: 2px;
            margin: 2px 0;
            display: none;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-height: none;
            height: auto;
        }
        
        .form-value.has-content {
            color: #1a73e8 !important;
            font-weight: 500;
            background-color: #f8fbff;
            border-left: 3px solid #1a73e8;
        }
        
        .form-value.empty {
            color: #999;
            font-style: italic;
            background-color: #f9f9f9;
        }
        
        .form-value.show {
            display: block;
        }
        
        .form-input.has-content, .form-textarea.has-content, .form-select.has-content {
            color: #1a73e8 !important;
            border-color: #1a73e8 !important;
            background-color: #f8fbff !important;
        }
        
        .form-checkbox:checked + label {
            color: #1a73e8 !important;
            font-weight: 500;
        }
        
        textarea.form-textarea {
            min-height: 80px;
            resize: vertical;
            overflow-y: auto;
        }
        
        .long-content {
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: break-word;
            min-height: 40px;
            height: auto;
            max-height: none;
        }
        
        .conclusion-cell {
            min-height: 150px;
            height: auto;
        }
        
        /* Thêm CSS cho multi-user */
        .cloud-status {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .cloud-status .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .online { background-color: #4CAF50; }
        .offline { background-color: #f44336; }
        .syncing { background-color: #FF9800; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .share-link-container {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            display: none;
        }
        
        .share-link {
            word-break: break-all;
            background: white;
            padding: 8px;
            border-radius: 3px;
            margin-top: 5px;
        }
        
        .user-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #4a6fa5;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        
        .loading-content {
            background: white;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4a6fa5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Cloud Status Bar -->
    <div class="cloud-status no-print">
        <div>
            <span class="status-indicator offline" id="cloudStatus"></span>
            <span id="cloudStatusText">Chưa kết nối cloud</span>
            <span id="lastSyncTime" style="margin-left: 15px; font-size: 10px;"></span>
        </div>
        <div id="userCount" style="display: flex; align-items: center; gap: 5px;">
            <i class="fas fa-users"></i>
            <span id="activeUsers">0 người đang online</span>
        </div>
    </div>

    <!-- Share Link Container -->
    <div class="share-link-container no-print" id="shareLinkContainer">
        <strong><i class="fas fa-share-alt"></i> LINK CHIA SẺ:</strong>
        <div class="share-link" id="shareLinkText"></div>
        <button onclick="copyShareLink()" style="margin-top: 10px; padding: 5px 10px;">
            <i class="fas fa-copy"></i> Copy Link
        </button>
        <button onclick="hideShareLink()" style="margin-top: 10px; margin-left: 10px; padding: 5px 10px;">
            <i class="fas fa-times"></i> Đóng
        </button>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <div id="loadingMessage">Đang xử lý...</div>
        </div>
    </div>

    <!-- Buttons for actions -->
    <div class="buttons-container no-print">
        <button type="button" class="btn btn-success" id="saveToCloud">
            <i class="fas fa-cloud-upload-alt"></i> Lưu lên Cloud
        </button>
        <button type="button" class="btn btn-primary" id="shareForm">
            <i class="fas fa-share-alt"></i> Chia sẻ
        </button>
        <button type="button" class="btn btn-success" id="exportPdf">
            <i class="fas fa-file-pdf"></i> Xuất PDF
        </button>
        <button type="button" class="btn btn-danger" id="resetForm">
            <i class="fas fa-redo"></i> Làm mới
        </button>
        <button type="button" class="btn btn-primary" id="printForm">
            <i class="fas fa-print"></i> In trực tiếp
        </button>
    </div>

    <!-- Main form container -->
    <div class="container" id="main-form">
        <div class="form-content">
            <!-- Header -->
            <div class="header">
                <h1>BIỂU GHI NPI - NPI RECORD (CLOUD VERSION)</h1>
                <div style="font-size: 12px; margin-top: 5px;">TNEMS-EN-F-048-NPI RECORD-VER03 - Đồng bộ đa người dùng</div>
            </div>
            
            <!-- Product Information Section -->
            <div class="form-section" id="section-product-info">
                <div class="section-title">THÔNG TIN SẢN PHẨM - PRODUCT INFORMATION</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="model">MÃ HÀNG / MODEL: <span class="required">*</span></label>
                        <input type="text" id="model" placeholder="Nhập mã hàng/model" class="form-input required-field">
                        <div class="form-value" id="model-display"></div>
                        <div class="error-message" id="model-error">Vui lòng nhập mã hàng</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="customer">KHÁCH HÀNG / CUSTOMER: <span class="required">*</span></label>
                        <input type="text" id="customer" placeholder="Nhập tên khách hàng" class="form-input required-field">
                        <div class="form-value" id="customer-display"></div>
                        <div class="error-message" id="customer-error">Vui lòng nhập tên khách hàng</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="partNo">Part No:</label>
                        <input type="text" id="partNo" placeholder="Nhập Part No" class="form-input">
                        <div class="form-value" id="partNo-display"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group" style="flex: 2;">
                        <label>Quy trình / Process:</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="processSMT" value="SMT" class="form-checkbox">
                                <label for="processSMT">SMT</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="processThroughHole" value="THROUGH HOLE" class="form-checkbox">
                                <label for="processThroughHole">THROUGH HOLE</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="processCoating" value="COATING" class="form-checkbox">
                                <label for="processCoating">COATING</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="processBoxbuild" value="BOXBUILD" class="form-checkbox">
                                <label for="processBoxbuild">BOXBUILD</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="processPacking" value="PACKING" class="form-checkbox">
                                <label for="processPacking">PACKING</label>
                            </div>
                        </div>
                        <div class="form-value" id="process-display"></div>
                    </div>
                    
                    <div class="form-group" style="flex: 1;">
                        <label for="date">Ngày / Date:</label>
                        <input type="date" id="date" value="" class="form-input">
                        <div class="form-value" id="date-display"></div>
                    </div>
                </div>
            </div>

            <!-- SMT Section -->
            <div class="form-section" id="section-smt">
                <div class="section-title">SMT PROCESS</div>
                
                <!-- LASER MARKING -->
                <div class="sub-section-title">LASER MARKING</div>
                <table>
                    <tr>
                        <th width="30%">NỘI DUNG</th>
                        <th width="70%">GIÁ TRỊ</th>
                    </tr>
                    <tr>
                        <td>Tên chương trình/ Program name</td>
                        <td>
                            <input type="text" id="laserProgram" placeholder="Nhập tên chương trình" style="width: 100%;" class="form-input">
                            <div class="form-value" id="laserProgram-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Loại QR code/ QR code type</td>
                        <td>
                            <input type="text" id="qrType" placeholder="Nhập loại QR code" style="width: 100%;" class="form-input">
                            <div class="form-value" id="qrType-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Kích thước QR code/ QR code size</td>
                        <td>
                            <input type="text" id="qrSize" placeholder="Nhập kích thước QR code" style="width: 100%;" class="form-input">
                            <div class="form-value" id="qrSize-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Cường độ khắc/ Engraving intensity</td>
                        <td>
                            <input type="text" id="engravingIntensity" placeholder="Nhập cường độ khắc" style="width: 100%;" class="form-input">
                            <div class="form-value" id="engravingIntensity-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Side BOT: Nội dung QR code/ QR code content</td>
                        <td class="long-content-cell">
                            <textarea id="qrContentBot" placeholder="Nhập nội dung QR code mặt BOT" rows="3" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="qrContentBot-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Side TOP: Nội dung QR code/ QR code content</td>
                        <td class="long-content-cell">
                            <textarea id="qrContentTop" placeholder="Nhập nội dung QR code mặt TOP" rows="3" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="qrContentTop-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Nội dung QR code khi quét bằng máy</td>
                        <td class="long-content-cell">
                            <textarea id="qrScanContent" placeholder="Nhập nội dung khi quét QR" rows="3" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="qrScanContent-display"></div>
                        </td>
                    </tr>
                </table>
                
                <!-- PRINTER -->
                <div class="sub-section-title">PRINTER</div>
                <div class="form-row">
                    <div class="form-group full-width">
                        <input type="text" id="printerControl" placeholder="Ghi chú về printer" value="Theo Process control sheet đính kèm/According to the attached Process Control Sheet" style="width: 100%;" class="form-input">
                        <div class="form-value" id="printerControl-display"></div>
                    </div>
                </div>
                
                <!-- MOUNTER -->
                <div class="sub-section-title">MOUNTER</div>
                <div class="form-row">
                    <div class="form-group full-width">
                        <input type="text" id="mounterControl" placeholder="Ghi chú về mounter" value="Theo Process control sheet đính kèm (có xác nhận và đo giá trị của các bên)/According to the attached Process Control Sheet" style="width: 100%;" class="form-input">
                        <div class="form-value" id="mounterControl-display"></div>
                    </div>
                </div>
                
                <!-- VISUAL INSPECTION 1 -->
                <div class="sub-section-title">NGOẠI QUAN VISUAL INSPECTION</div>
                <table>
                    <tr>
                        <th width="40%">HƯỚNG LINH KIỆN/COMPONENT POLARITY</th>
                        <th width="30%">SỐ LƯỢNG LINH KIỆN/COMPONENT QUANTITY</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="15%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>Theo bảng hướng linh kiện đính kèm (QC)</td>
                        <td>
                            <div>Theo BOM/ According to the BOM: 
                                <input type="text" id="bomQty" class="input-small form-input" placeholder="Số lượng">
                                <span class="form-value" id="bomQty-display"></span>
                            </div>
                            <div style="margin-top: 5px;">Thực tế/ Reality: 
                                <input type="text" id="actualQty" class="input-small form-input" placeholder="Số lượng">
                                <span class="form-value" id="actualQty-display"></span>
                            </div>
                        </td>
                        <td style="text-align: center;">
                            <select id="visualResult1" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="visualResult1-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="engVerify1" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="engVerify1-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="qcVerify1" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="qcVerify1-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- REFLOW OVEN Section -->
            <div class="form-section" id="section-reflow">
                <div class="sub-section-title">LÒ REFLOW/REFLOW OVEN</div>
                <table>
                    <tr>
                        <th width="30%">TÊN CHƯƠNG TRÌNH/PROGRAM NAME</th>
                        <th width="40%">THÔNG SỐ CÀI ĐẶT MÁY/MACHINE PARAMETERS SETTING</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="15%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>
                            - Theo Process control sheet đính kèm<br>
                            - Profile lò đính kèm
                        </td>
                        <td class="long-content-cell">
                            <textarea id="reflowParams" placeholder="Thông số cài đặt" rows="4" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="reflowParams-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="reflowResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="reflowResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="reflowEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="reflowEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="reflowQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="reflowQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- AOI -->
                <div class="sub-section-title">AOI/AUTOMATED OPTICAL INSPECTION</div>
                <table>
                    <tr>
                        <th width="30%">TÊN CHƯƠNG TRÌNH/PROGRAM NAME</th>
                        <th width="25%">SỐ LƯỢNG PCBA ĐÃ AOI/PCBA AOI INSPECTED QUANTITY</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="30%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>
                            <div>BOT: 
                                <input type="text" id="aoiProgramBot" class="input-medium form-input" placeholder="Tên chương trình">
                                <span class="form-value" id="aoiProgramBot-display"></span>
                            </div>
                            <div style="margin-top: 5px;">TOP: 
                                <input type="text" id="aoiProgramTop" class="input-medium form-input" placeholder="Tên chương trình">
                                <span class="form-value" id="aoiProgramTop-display"></span>
                            </div>
                        </td>
                        <td>
                            <input type="text" id="aoiQty" class="input-small form-input" placeholder="Số lượng" style="width: 100%;">
                            <div class="form-value" id="aoiQty-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="aoiResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="aoiResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="aoiEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="aoiEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="aoiQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="aoiQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- FLYING PROBE -->
                <div class="sub-section-title">FLYING PROBE (20%)</div>
                <table>
                    <tr>
                        <th width="30%">TÊN CHƯƠNG TRÌNH/PROGRAM NAME</th>
                        <th width="25%">SỐ LƯỢNG ĐÃ ĐO/MEASURED QUANTITY</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="30%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>
                            <div>BOT: 
                                <input type="text" id="probeProgramBot" class="input-medium form-input" placeholder="Tên chương trình">
                                <span class="form-value" id="probeProgramBot-display"></span>
                            </div>
                            <div style="margin-top: 5px;">TOP: 
                                <input type="text" id="probeProgramTop" class="input-medium form-input" placeholder="Tên chương trình">
                                <span class="form-value" id="probeProgramTop-display"></span>
                            </div>
                        </td>
                        <td>
                            <input type="text" id="probeQty" class="input-small form-input" placeholder="Số lượng" style="width: 100%;">
                            <div class="form-value" id="probeQty-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="probeResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="probeResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="probeEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="probeEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="probeQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="probeQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- VISUAL INSPECTION 2 -->
                <div class="sub-section-title">NGOẠI QUAN VISUAL INSPECTION</div>
                <div class="note" style="margin-bottom: 10px;">
                    KIỂM TRA SỐ LƯỢNG LINH KIỆN, CHẤT LƯỢNG MỐI HÀN, HƯỚNG LINH KIỆN, CÁC LỖI ĐÁNH GIÁ THEO IPC
                </div>
                <table>
                    <tr>
                        <th width="40%">NỘI DUNG KIỂM TRA</th>
                        <th width="30%">KẾT QUẢ</th>
                        <th width="30%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>- Số lượng linh kiện/ Component Quantity</td>
                        <td style="text-align: center;">
                            <select id="visual2Result1" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="visual2Result1-display"></div>
                        </td>
                        <td rowspan="4" style="text-align: center; vertical-align: middle;">
                            <div>ENG: 
                                <input type="text" id="visual2Eng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="visual2Eng-display"></span>
                            </div>
                            <div style="margin-top: 10px;">QC: 
                                <input type="text" id="visual2Qc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="visual2Qc-display"></span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>- Chất lượng mối hàn/ Solder Joint Quality</td>
                        <td style="text-align: center;">
                            <select id="visual2Result2" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="visual2Result2-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>- Hướng linh kiện/ Component Orientation</td>
                        <td style="text-align: center;">
                            <select id="visual2Result3" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="visual2Result3-display"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>- Các lỗi đánh giá theo IPC/ Defects Evaluated per IPC</td>
                        <td style="text-align: center;">
                            <select id="visual2Result4" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="visual2Result4-display"></div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- THROUGH-HOLE Section -->
            <div class="form-section" id="section-through-hole">
                <div class="section-title">HÀN XUYÊN LỖ/ THROUGH-HOLE</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="thDate">Ngày kiểm tra/ Date:</label>
                        <input type="date" id="thDate" class="form-input">
                        <div class="form-value" id="thDate-display"></div>
                    </div>
                </div>
                
                <!-- COMPONENT QUANTITY CHECK -->
                <div class="sub-section-title">KIỂM TRA SỐ LƯỢNG LINH KIỆN/COMPONENT QUANTITY CHECK</div>
                <table>
                    <tr>
                        <th width="30%">ĐÚNG MÃ/CORRECT PART NUMBER</th>
                        <th width="20%">SỐ LƯỢNG/QUANTITY</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="35%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>
                            <input type="text" id="thPartNumber" placeholder="Mã linh kiện" style="width: 100%;" class="form-input">
                            <div class="form-value" id="thPartNumber-display"></div>
                        </td>
                        <td>
                            <input type="text" id="thQty" placeholder="Số lượng" style="width: 100%;" class="form-input">
                            <div class="form-value" id="thQty-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="thResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="thResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="thEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="thEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="thQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="thQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- SOLDERING -->
                <div class="sub-section-title">HÀN/SOLDERING</div>
                <table>
                    <tr>
                        <th width="40%">NHIỆT ĐỘ CÀI ĐẶT HÀN TAY/HAND SOLDERING TEMPERATURE SETTING</th>
                        <th width="40%">HÀN SELECTIVE/SELECTIVE SOLDERING</th>
                        <th width="10%">KẾT QUẢ/RESULT</th>
                        <th width="10%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>
                            <input type="text" id="handSolderingTemp" placeholder="Nhiệt độ hàn tay" style="width: 100%;" class="form-input">
                            <div class="form-value" id="handSolderingTemp-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <div>Loại nozzle/Nozzle type: 
                                <input type="text" id="nozzleType" class="input-medium form-input" placeholder="Loại nozzle">
                                <span class="form-value" id="nozzleType-display"></span>
                            </div>
                            <div style="margin-top: 5px;">Preheat (ºC): 
                                <input type="text" id="preheatTemp" class="input-small form-input" placeholder="Nhiệt độ">
                                <span class="form-value" id="preheatTemp-display"></span>
                                Solder pot (ºC): 
                                <input type="text" id="solderPotTemp" class="input-small form-input" placeholder="Nhiệt độ">
                                <span class="form-value" id="solderPotTemp-display"></span>
                            </div>
                            <div style="margin-top: 5px;">Thời gian preheat (s): 
                                <input type="text" id="preheatTime" class="input-small form-input" placeholder="Thời gian">
                                <span class="form-value" id="preheatTime-display"></span>
                            </div>
                        </td>
                        <td style="text-align: center;">
                            <select id="solderingResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="solderingResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="solderingEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="solderingEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="solderingQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="solderingQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- TESTING -->
                <div class="sub-section-title">TESTING</div>
                <table>
                    <tr>
                        <th width="30%">GIÁ TRỊ KIỂM TRA/INSPECTION VALUE</th>
                        <th width="40%">CÁC BƯỚC KIỂM TRA/INSPECTION STEPS</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="15%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>Xem file đính kèm Test đính kèm</td>
                        <td>Xem file đính kèm Test đính kèm</td>
                        <td style="text-align: center;">
                            <select id="testingResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="testingResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="testingEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="testingEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="testingQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="testingQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- PCBA CLEANING Section -->
            <div class="form-section" id="section-cleaning">
                <div class="sub-section-title">VỆ SINH PCBA/PCBA CLEANING</div>
                <table>
                    <tr>
                        <th width="25%">PHƯƠNG PHÁP VỆ SINH/CLEANING METHOD</th>
                        <th width="35%">DỤNG CỤ VỆ SINH PCBA/PCBA CLEANING TOOLS</th>
                        <th width="20%">DUNG DỊCH VỆ SINH PCBA/PCBA CLEANING SOLUTION</th>
                        <th width="10%">KẾT QUẢ/RESULT</th>
                        <th width="10%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <input type="text" id="cleaningMethod" placeholder="Phương pháp vệ sinh" style="width: 100%;" class="form-input">
                            <div class="form-value" id="cleaningMethod-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <input type="text" id="cleaningTools" placeholder="Dụng cụ vệ sinh" style="width: 100%;" class="form-input">
                            <div class="form-value" id="cleaningTools-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <input type="text" id="cleaningSolution" placeholder="Dung dịch vệ sinh" style="width: 100%;" class="form-input">
                            <div class="form-value" id="cleaningSolution-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="cleaningResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="cleaningResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="cleaningEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="cleaningEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="cleaningQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="cleaningQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- VISUAL INSPECTION 3 -->
                <div class="sub-section-title">NGOẠI QUAN VISUAL INSPECTION</div>
                <table>
                    <tr>
                        <th width="40%">CHẤT LƯỢNG MỐI HÀN VÀ VỆ SINH SẢN PHẨM/SOLDER JOINT QUALITY AND PRODUCT CLEANLINESS</th>
                        <th width="40%">ĐÚNG, ĐỦ LINH KIỆN/CORRECT AND COMPLETE COMPONENTS</th>
                        <th width="10%">KẾT QUẢ/RESULT</th>
                        <th width="10%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <textarea id="solderQuality" placeholder="Chất lượng mối hàn và vệ sinh" rows="4" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="solderQuality-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <textarea id="componentCorrectness" placeholder="Đúng đủ linh kiện" rows="4" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="componentCorrectness-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="visual3Result" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="visual3Result-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="visual3Eng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="visual3Eng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="visual3Qc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="visual3Qc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- COATING Section -->
            <div class="form-section" id="section-coating">
                <div class="section-title">COATING</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="coatingDate">Ngày kiểm tra/ Date:</label>
                        <input type="date" id="coatingDate" class="form-input">
                        <div class="form-value" id="coatingDate-display"></div>
                    </div>
                </div>
                
                <table>
                    <tr>
                        <th width="50%">NỘI DUNG KIỂM TRA/INSPECTION CONTENT</th>
                        <th width="20%">KẾT QUẢ/RESULT</th>
                        <th width="30%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <div>- Dung dịch coating/ Coating solution: 
                                <input type="text" id="coatingSolution" class="input-medium form-input" placeholder="Dung dịch">
                                <span class="form-value" id="coatingSolution-display"></span>
                            </div>
                            <div style="margin-top: 5px;">- Phương pháp coating/ Coating method: 
                                <input type="text" id="coatingMethod" class="input-medium form-input" placeholder="Phương pháp">
                                <span class="form-value" id="coatingMethod-display"></span>
                            </div>
                            <div style="margin-top: 5px;">- Phương pháp sấy/ Drying method: 
                                <input type="text" id="dryingMethod" class="input-medium form-input" placeholder="Phương pháp">
                                <span class="form-value" id="dryingMethod-display"></span>
                            </div>
                            <div style="margin-top: 5px;">- Nhiệt độ sấy/ Drying temperature: 
                                <input type="text" id="dryingTemp" class="input-small form-input" placeholder="Nhiệt độ">
                                <span class="form-value" id="dryingTemp-display"></span>
                                ºC
                            </div>
                            <div style="margin-top: 5px;">- Thời gian sấy/ Drying time: 
                                <input type="text" id="dryingTime" class="input-small form-input" placeholder="Thời gian">
                                <span class="form-value" id="dryingTime-display"></span>
                                phút
                            </div>
                        </td>
                        <td style="text-align: center;">
                            <select id="coatingResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="coatingResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="coatingEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="coatingEng-display"></span>
                            </div>
                            <div style="margin-top: 10px;">QC: 
                                <input type="text" id="coatingQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="coatingQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- BOXBUILD Section -->
            <div class="form-section" id="section-boxbuild">
                <div class="section-title">LẮP RÁP / BOXBUILD</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="boxbuildDate">Ngày kiểm tra/ Date:</label>
                        <input type="date" id="boxbuildDate" class="form-input">
                        <div class="form-value" id="boxbuildDate-display"></div>
                    </div>
                </div>
                
                <!-- ASSEMBLY JIG OR TOOL -->
                <div class="sub-section-title">LẮP RÁP BOXBUILD</div>
                <table>
                    <tr>
                        <th width="30%">JIG/DỤNG CỤ LẮP RÁP/ASSEMBLY JIG OR TOOL</th>
                        <th width="40%">TIÊU CHUẨN/SPECIFICATION</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="15%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <input type="text" id="assemblyJig" placeholder="Jig/dụng cụ lắp ráp" style="width: 100%;" class="form-input">
                            <div class="form-value" id="assemblyJig-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <input type="text" id="assemblySpec" placeholder="Tiêu chuẩn" style="width: 100%;" class="form-input">
                            <div class="form-value" id="assemblySpec-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="assemblyResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="assemblyResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="assemblyEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="assemblyEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="assemblyQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="assemblyQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- ASSEMBLY COMPONENT QUANTITY -->
                <table style="margin-top: 10px;">
                    <tr>
                        <th width="30%">SỐ LƯỢNG LINH KIỆN LẮP RÁP/ASSEMBLY COMPONENT QUANTITY</th>
                        <th width="40%">HƯỚNG/CHIỀU LẮP LINH KIỆN/COMPONENT ORIENTATION</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="15%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <input type="text" id="assemblyQty" placeholder="Số lượng linh kiện" style="width: 100%;" class="form-input">
                            <div class="form-value" id="assemblyQty-display"></div>
                        </td>
                        <td>Theo bản vẽ/ According to the drawing</td>
                        <td style="text-align: center;">
                            <select id="assemblyOrientationResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="assemblyOrientationResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="assemblyOrientationEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="assemblyOrientationEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="assemblyOrientationQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="assemblyOrientationQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
                
                <!-- IMEI / LABEL -->
                <div class="sub-section-title">IMEI / LABEL</div>
                <table>
                    <tr>
                        <th width="25%">VỊ TRÍ DÁN NHÃN/LABEL POSITION</th>
                        <th width="25%">HƯỚNG DÁN NHÃN/LABEL ORIENTATION</th>
                        <th width="30%">NỘI DUNG NHÃN/LABEL CONTENT</th>
                        <th width="10%">KẾT QUẢ/RESULT</th>
                        <th width="10%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <input type="text" id="labelPosition" placeholder="Vị trí dán nhãn" style="width: 100%;" class="form-input">
                            <div class="form-value" id="labelPosition-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <input type="text" id="labelOrientation" placeholder="Hướng dán nhãn" style="width: 100%;" class="form-input">
                            <div class="form-value" id="labelOrientation-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <textarea id="labelContent" placeholder="Nội dung nhãn" rows="4" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="labelContent-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="labelResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="labelResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="labelEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="labelEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="labelQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="labelQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- VISUAL INSPECTION 4 Section -->
            <div class="form-section" id="section-visual4">
                <div class="sub-section-title">KIỂM TRA NGOẠI QUAN/VISUAL INSPECTION</div>
                <table>
                    <tr>
                        <th width="60%">TIÊU CHUẨN KIỂM TRA/INSPECTION REQUIREMENT</th>
                        <th width="20%">KẾT QUẢ/RESULT</th>
                        <th width="20%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <textarea id="inspectionRequirement" placeholder="Tiêu chuẩn kiểm tra" rows="5" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="inspectionRequirement-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="boxbuildVisualResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="boxbuildVisualResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="boxbuildVisualEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="boxbuildVisualEng-display"></span>
                            </div>
                            <div style="margin-top: 10px;">QC: 
                                <input type="text" id="boxbuildVisualQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="boxbuildVisualQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- PACKAGING Section -->
            <div class="form-section" id="section-packaging">
                <div class="section-title">ĐÓNG GÓI / PACKAGING</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="packagingDate">Ngày kiểm tra/ Date:</label>
                        <input type="date" id="packagingDate" class="form-input">
                        <div class="form-value" id="packagingDate-display"></div>
                    </div>
                </div>
                
                <!-- PACKAGING MATERIAL -->
                <div class="sub-section-title">ĐÓNG GÓI/PACKAGING</div>
                <table>
                    <tr>
                        <th width="25%">VẬT LIỆU ĐÓNG GÓI/PACKAGING MATERIAL</th>
                        <th width="25%">PHƯƠNG PHÁP ĐÓNG GÓI</th>
                        <th width="20%">SỐ LƯỢNG/THÙNG/QUANTITY PER BOX</th>
                        <th width="15%">KẾT QUẢ/RESULT</th>
                        <th width="15%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td>
                            - Theo BOM Đính kèm/ Attached BOM<br>
                            - Bổ sung (nếu có)/ Additional (if any)
                        </td>
                        <td class="long-content-cell">
                            <input type="text" id="packagingMethod" placeholder="Phương pháp đóng gói" style="width: 100%;" class="form-input">
                            <div class="form-value" id="packagingMethod-display"></div>
                        </td>
                        <td class="long-content-cell">
                            <input type="text" id="qtyPerBox" placeholder="Số lượng/thùng" style="width: 100%;" class="form-input">
                            <div class="form-value" id="qtyPerBox-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <select id="packagingResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="packagingResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="packagingEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="packagingEng-display"></span>
                            </div>
                            <div style="margin-top: 2px;">QC: 
                                <input type="text" id="packagingQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="packagingQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- LABEL Section -->
            <div class="form-section" id="section-label">
                <div class="sub-section-title">LABEL</div>
                <table>
                    <tr>
                        <th width="40%">NỘI DUNG LABEL/LABEL CONTENT</th>
                        <th width="40%">MẪU HOẶC HÌNH ẢNH LABEL THỰC TẾ/ACTUAL IMAGE/ SAMPLE</th>
                        <th width="10%">KẾT QUẢ/RESULT</th>
                        <th width="10%">XÁC NHẬN/VERIFY</th>
                    </tr>
                    <tr>
                        <td class="long-content-cell">
                            <textarea id="packagingLabelContent" placeholder="Nội dung label" rows="5" style="width: 100%;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content" id="packagingLabelContent-display"></div>
                        </td>
                        <td>
                            <div class="note">- Thêm hình ảnh hoặc mẫu thực tế vào ô này<br>- Add actual image in this box</div>
                            <div style="margin-top: 5px;">
                                <input type="file" id="labelImage" accept="image/*" style="width: 100%; font-size: 11px;" class="no-print">
                                <div id="labelImagePreview" style="margin-top: 5px; min-height: 50px; border: 1px dashed #ccc; padding: 5px;"></div>
                            </div>
                        </td>
                        <td style="text-align: center;">
                            <select id="packagingLabelResult" style="width: 100%;" class="form-select">
                                <option value="OK">OK</option>
                                <option value="NG">NG</option>
                            </select>
                            <div class="form-value" id="packagingLabelResult-display"></div>
                        </td>
                        <td style="text-align: center;">
                            <div>ENG: 
                                <input type="text" id="packagingLabelEng" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="packagingLabelEng-display"></span>
                            </div>
                            <div style="margin-top: 10px;">QC: 
                                <input type="text" id="packagingLabelQc" class="input-medium form-input" placeholder="Tên">
                                <span class="form-value" id="packagingLabelQc-display"></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- CONCLUSION Section -->
            <div class="form-section" id="section-conclusion">
                <div class="section-title">KẾT LUẬN/ CONCLUSION</div>
                
                <table>
                    <tr>
                        <th width="20%">KẾT QUẢ CUỐI CÙNG/FINAL RESULT</th>
                        <th width="25%">RỦI RO TRONG CÁC CÔNG ĐOẠN/RISKS IN EACH PROCESS STEP</th>
                        <th width="25%">BÀI HỌC TỪNG CÔNG ĐOẠN/LESSONS LEARNED FROM EACH PROCESS STEP</th>
                        <th width="30%">CẢI TIẾN CÔNG ĐOẠN/PROCESS IMPROVEMENT</th>
                    </tr>
                    <tr>
                        <td style="text-align: center; vertical-align: middle;" class="conclusion-cell">
                            <select id="finalResult" style="width: 90%;" class="form-select">
                                <option value="PASS">PASS</option>
                                <option value="FAIL">FAIL</option>
                                <option value="CONDITIONAL">CONDITIONAL PASS</option>
                            </select>
                            <div class="form-value" id="finalResult-display"></div>
                        </td>
                        <td class="conclusion-cell long-content-cell">
                            <textarea id="processRisks" placeholder="Rủi ro trong các công đoạn" rows="8" style="width: 100%; height: auto; min-height: 120px;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content conclusion-content" id="processRisks-display"></div>
                        </td>
                        <td class="conclusion-cell long-content-cell">
                            <textarea id="lessonsLearned" placeholder="Bài học từng công đoạn" rows="8" style="width: 100%; height: auto; min-height: 120px;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content conclusion-content" id="lessonsLearned-display"></div>
                        </td>
                        <td class="conclusion-cell long-content-cell">
                            <textarea id="processImprovement" placeholder="Cải tiến công đoạn" rows="8" style="width: 100%; height: auto; min-height: 120px;" class="form-textarea long-content"></textarea>
                            <div class="form-value long-content conclusion-content" id="processImprovement-display"></div>
                        </td>
                    </tr>
                </table>
                
                <div class="form-row" style="margin-top: 15px;">
                    <div class="form-group">
                        <label for="totalQty">Tổng số lượng (PCBA): <br>Total qty (PCBA):</label>
                        <input type="number" id="totalQty" placeholder="Nhập tổng số lượng" class="form-input">
                        <div class="form-value" id="totalQty-display"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="okQty">OK :</label>
                        <input type="number" id="okQty" placeholder="Nhập số lượng OK" class="form-input">
                        <div class="form-value" id="okQty-display"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="ngQty">NG (scrap) :</label>
                        <input type="number" id="ngQty" placeholder="Nhập số lượng NG" class="form-input">
                        <div class="form-value" id="ngQty-display"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="defectRate">Tỷ lệ lỗi/ Defect rate (%) : <br> (NG/Total)</label>
                        <input type="text" id="defectRate" placeholder="Tự động tính toán" readonly style="background-color: #f0f0f0;" class="form-input">
                        <div class="form-value" id="defectRate-display"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="defectDescription">Mô tả chi tiết lỗi / detailed defect description:</label>
                        <textarea id="defectDescription" placeholder="Mô tả chi tiết các lỗi" rows="4" style="width: 100%;" class="form-textarea long-content"></textarea>
                        <div class="form-value long-content" id="defectDescription-display"></div>
                    </div>
                </div>
                
                <!-- Electronic Signatures -->
                <div class="sub-section-title">XÁC NHẬN ĐIỆN TỬ - ELECTRONIC SIGNATURES</div>
                <div class="two-column" style="margin-top: 10px;">
                    <div class="signature-section">
                        <label>Ký xác nhận của Kỹ sư / Engineer Signature:</label>
                        <div class="signature-container">
                            <canvas id="engineerSignature" class="signature-pad no-export"></canvas>
                            <div class="signature-controls no-print no-export">
                                <button type="button" id="clearEngineerSignature">Xóa chữ ký</button>
                                <button type="button" id="saveEngineerSignature">Lưu chữ ký</button>
                            </div>
                            <div class="signature-display" id="engineerSignatureDisplay">
                                <div style="padding: 10px; text-align: center;">Chữ ký sẽ hiển thị ở đây sau khi lưu</div>
                            </div>
                        </div>
                        <div style="margin-top: 5px;">
                            <label for="engineerName" class="inline-label">Tên Kỹ sư / Engineer Name:</label>
                            <input type="text" id="engineerName" placeholder="Nhập tên kỹ sư" style="width: 200px;" class="form-input">
                            <span class="form-value" id="engineerName-display"></span>
                        </div>
                    </div>
                    
                    <div class="signature-section">
                        <label>Ký xác nhận của QC / QC Signature:</label>
                        <div class="signature-container">
                            <canvas id="qcSignature" class="signature-pad no-export"></canvas>
                            <div class="signature-controls no-print no-export">
                                <button type="button" id="clearQcSignature">Xóa chữ ký</button>
                                <button type="button" id="saveQcSignature">Lưu chữ ký</button>
                            </div>
                            <div class="signature-display" id="qcSignatureDisplay">
                                <div style="padding: 10px; text-align: center;">Chữ ký sẽ hiển thị ở đây sau khi lưu</div>
                            </div>
                        </div>
                        <div style="margin-top: 5px;">
                            <label for="qcName" class="inline-label">Tên QC / QC Name:</label>
                            <input type="text" id="qcName" placeholder="Nhập tên QC" style="width: 200px;" class="form-input">
                            <span class="form-value" id="qcName-display"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <p>NPI Record Cloud Version - Dữ liệu đồng bộ đa người dùng</p>
                <p>© 2024 - Phiên bản Cloud 1.0</p>
                <p style="font-size: 10px; color: #888;" id="dataInfo"></p>
            </div>
        </div>
    </div>

    <script>
// ============================================
// CẤU HÌNH DỄ DÀNG - CHỈ CẦN THAY 2 DÒNG NÀY
// ============================================

// CÁCH 1: Dùng GitHub Gist (Miễn phí, tốt nhất)
// const CLOUD_TYPE = 'gist'; // 'gist', 'firebase', 'supabase', 'jsonbin'
// const GITHUB_TOKEN = 'ghp_your_token_here'; // Thay bằng token của bạn

// CÁCH 2: Dùng JSONBin.io (DỄ NHẤT - không cần token)
// const CLOUD_TYPE = 'jsonbin';
// const JSONBIN_API_KEY = '$2a$10$your_bin_id_here'; // Tạo free tại jsonbin.io

// CÁCH 3: SIÊU DỄ - Không cần token gì cả!
const CLOUD_TYPE = 'local'; // Không cần cấu hình gì!

// ============================================
// KHÔNG CẦN SỬA GÌ DƯỚI ĐÂY
// ============================================

let currentProjectId = null;
let isOnline = false;
let autoSaveInterval = null;
let syncInterval = null;
let lastSavedTime = null;
let currentUser = null;

// Tạo user ID ngẫu nhiên cho mỗi người dùng
function generateUserId() {
    return 'user_' + Math.random().toString(36).substr(2, 9);
}

// Khởi tạo
document.addEventListener('DOMContentLoaded', function() {
    // Tạo user ID
    currentUser = localStorage.getItem('npi_user_id') || generateUserId();
    localStorage.setItem('npi_user_id', currentUser);
    
    // Set ngày mặc định
    const today = new Date().toISOString().split('T')[0];
    ['date', 'thDate', 'coatingDate', 'boxbuildDate', 'packagingDate'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = today;
    });
    
    // Kiểm tra URL có project ID không
    const urlParams = new URLSearchParams(window.location.search);
    const projectId = urlParams.get('project');
    
    if (projectId) {
        currentProjectId = projectId;
        loadFromCloud(projectId);
        updateStatus('Đang tải dữ liệu từ cloud...', 'syncing');
    } else {
        // Tạo project ID mới từ ngày và mã hàng (nếu có)
        updateDataInfo('Chưa có dự án. Lưu lên cloud để tạo link chia sẻ.');
    }
    
    // Thiết lập listeners
    setupFormListeners();
    setupEventListeners();
    
    // Auto-save mỗi 30 giây
    autoSaveInterval = setInterval(autoSave, 30000);
    
    // Auto-sync mỗi 60 giây
    syncInterval = setInterval(checkForUpdates, 60000);
    
    // Cập nhật trạng thái
    updateCloudStatus();
});

// ========== CÁC HÀM CLOUD ==========

async function saveToCloud() {
    showLoading('Đang lưu lên cloud...');
    
    try {
        const formData = collectFormData();
        
        // Thêm metadata
        formData._metadata = {
            lastUpdated: new Date().toISOString(),
            updatedBy: currentUser,
            version: (formData._metadata?.version || 0) + 1
        };
        
        let result;
        
        switch(CLOUD_TYPE) {
            case 'gist':
                result = await saveToGist(formData);
                break;
            case 'jsonbin':
                result = await saveToJsonBin(formData);
                break;
            case 'firebase':
                result = await saveToFirebase(formData);
                break;
            default:
                // Fallback: localStorage + shareable URL
                result = await saveToLocalStorageWithShare(formData);
        }
        
        if (result && result.success) {
            lastSavedTime = new Date();
            updateStatus('Đã lưu lên cloud', 'online');
            updateLastSyncTime();
            
            if (result.projectId && !currentProjectId) {
                currentProjectId = result.projectId;
                updateShareLink(result.projectId);
            }
            
            showSuccess('Lưu thành công!');
            return true;
        } else {
            throw new Error('Lưu thất bại');
        }
        
    } catch (error) {
        console.error('Lỗi lưu cloud:', error);
        updateStatus('Lỗi kết nối cloud', 'offline');
        showError('Không thể lưu lên cloud. Đang lưu cục bộ...');
        
        // Fallback: lưu localStorage
        localStorage.setItem('npi_backup_' + Date.now(), JSON.stringify(collectFormData()));
        return false;
    } finally {
        hideLoading();
    }
}

async function loadFromCloud(projectId) {
    showLoading('Đang tải dữ liệu...');
    
    try {
        let data;
        
        switch(CLOUD_TYPE) {
            case 'gist':
                data = await loadFromGist(projectId);
                break;
            case 'jsonbin':
                data = await loadFromJsonBin(projectId);
                break;
            case 'firebase':
                data = await loadFromFirebase(projectId);
                break;
            default:
                data = await loadFromLocalStorage(projectId);
        }
        
        if (data) {
            populateForm(data);
            updateStatus('Đã tải dữ liệu', 'online');
            updateDataInfo(`Dữ liệu cập nhật: ${new Date(data._metadata?.lastUpdated || Date.now()).toLocaleString()}`);
            showSuccess('Tải dữ liệu thành công!');
            return true;
        }
        
    } catch (error) {
        console.error('Lỗi tải cloud:', error);
        updateStatus('Không tải được dữ liệu', 'offline');
        showError('Không thể tải dữ liệu từ cloud');
    } finally {
        hideLoading();
    }
    
    return false;
}

// ========== GITHUB GIST IMPLEMENTATION ==========

async function saveToGist(formData) {
    if (!GITHUB_TOKEN) {
        throw new Error('Chưa cấu hình GitHub Token');
    }
    
    const gistData = {
        files: {
            'npi_record.json': {
                content: JSON.stringify(formData, null, 2)
            }
        },
        description: `NPI Record - ${formData.model || 'Unknown Model'}`,
        public: false
    };
    
    let url = 'https://api.github.com/gists';
    let method = 'POST';
    
    if (currentProjectId) {
        url = `https://api.github.com/gists/${currentProjectId}`;
        method = 'PATCH';
    }
    
    const response = await axios({
        method: method,
        url: url,
        headers: {
            'Authorization': `token ${GITHUB_TOKEN}`,
            'Accept': 'application/vnd.github.v3+json'
        },
        data: gistData
    });
    
    const gistId = response.data.id;
    const projectId = gistId;
    
    // Lưu project ID để dùng sau
    if (!currentProjectId) {
        currentProjectId = projectId;
        localStorage.setItem('last_project_id', projectId);
    }
    
    return { success: true, projectId: projectId };
}

async function loadFromGist(gistId) {
    const response = await axios.get(`https://api.github.com/gists/${gistId}`);
    
    if (response.data && response.data.files && response.data.files['npi_record.json']) {
        const content = response.data.files['npi_record.json'].content;
        return JSON.parse(content);
    }
    
    return null;
}

// ========== JSONBIN.IO IMPLEMENTATION (DỄ NHẤT) ==========

async function saveToJsonBin(formData) {
    // Tạo free account tại jsonbin.io để lấy API key
    const binId = currentProjectId || 'new';
    const url = binId === 'new' 
        ? 'https://api.jsonbin.io/v3/b'
        : `https://api.jsonbin.io/v3/b/${binId}`;
    
    const response = await axios({
        method: binId === 'new' ? 'POST' : 'PUT',
        url: url,
        headers: {
            'Content-Type': 'application/json',
            'X-Master-Key': JSONBIN_API_KEY,
            'X-Bin-Name': `NPI Record - ${formData.model || 'Unknown'}`
        },
        data: formData
    });
    
    const newBinId = response.data.metadata?.id || currentProjectId;
    
    if (!currentProjectId && newBinId) {
        currentProjectId = newBinId;
        localStorage.setItem('last_project_id', newBinId);
    }
    
    return { success: true, projectId: newBinId };
}

async function loadFromJsonBin(binId) {
    const response = await axios.get(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
        headers: {
            'X-Master-Key': JSONBIN_API_KEY
        }
    });
    
    return response.data.record;
}

// ========== LOCALSTORAGE WITH SHAREABLE URL ==========

async function saveToLocalStorageWithShare(formData) {
    // Tạo project ID nếu chưa có
    if (!currentProjectId) {
        currentProjectId = 'npi_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5);
    }
    
    // Lưu vào localStorage với project ID
    localStorage.setItem('npi_project_' + currentProjectId, JSON.stringify(formData));
    
    // Lưu danh sách projects
    const projects = JSON.parse(localStorage.getItem('npi_projects') || '[]');
    if (!projects.includes(currentProjectId)) {
        projects.push(currentProjectId);
        localStorage.setItem('npi_projects', JSON.stringify(projects));
    }
    
    // Tạo shareable URL
    const shareUrl = `${window.location.origin}${window.location.pathname}?project=${currentProjectId}`;
    
    return { 
        success: true, 
        projectId: currentProjectId,
        shareUrl: shareUrl 
    };
}

async function loadFromLocalStorage(projectId) {
    const data = localStorage.getItem('npi_project_' + projectId);
    return data ? JSON.parse(data) : null;
}

// ========== CÁC HÀM TIỆN ÍCH ==========

function collectFormData() {
    const data = {};
    
    // Thu thập tất cả input, select, textarea có id
    document.querySelectorAll('[id]').forEach(element => {
        if (element.tagName === 'INPUT' || element.tagName === 'SELECT' || element.tagName === 'TEXTAREA') {
            if (element.type === 'checkbox') {
                data[element.id] = element.checked;
            } else if (element.type === 'radio') {
                if (element.checked) data[element.name] = element.value;
            } else {
                data[element.id] = element.value;
            }
        }
    });
    
    return data;
}

function populateForm(data) {
    Object.keys(data).forEach(key => {
        if (key.startsWith('_')) return; // Bỏ qua metadata
        
        const element = document.getElementById(key);
        if (element) {
            if (element.type === 'checkbox') {
                element.checked = Boolean(data[key]);
            } else if (element.type === 'radio') {
                const radio = document.querySelector(`input[name="${key}"][value="${data[key]}"]`);
                if (radio) radio.checked = true;
            } else {
                element.value = data[key] || '';
            }
            
            // Kích hoạt event để cập nhật display
            element.dispatchEvent(new Event('input'));
        }
    });
}

function setupFormListeners() {
    // Auto-resize textareas
    document.querySelectorAll('textarea').forEach(textarea => {
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight + 'px';
        });
        textarea.dispatchEvent(new Event('input'));
    });
    
    // Mark form changed
    document.querySelectorAll('input, textarea, select').forEach(element => {
        element.addEventListener('input', function() {
            updateStatus('Có thay đổi chưa lưu', 'syncing');
        });
    });
}

function setupEventListeners() {
    document.getElementById('saveToCloud').addEventListener('click', saveToCloud);
    document.getElementById('shareForm').addEventListener('click', showShareLink);
    document.getElementById('exportPdf').addEventListener('click', exportToPDF);
    document.getElementById('printForm').addEventListener('click', printForm);
    document.getElementById('resetForm').addEventListener('click', resetForm);
}

function updateStatus(message, status = 'offline') {
    const statusEl = document.getElementById('cloudStatus');
    const textEl = document.getElementById('cloudStatusText');
    
    if (statusEl) {
        statusEl.className = 'status-indicator ' + status;
    }
    
    if (textEl) {
        textEl.textContent = message;
    }
}

function updateLastSyncTime() {
    const timeEl = document.getElementById('lastSyncTime');
    if (timeEl && lastSavedTime) {
        timeEl.textContent = `Cập nhật: ${lastSavedTime.toLocaleTimeString()}`;
    }
}

function updateDataInfo(info) {
    const infoEl = document.getElementById('dataInfo');
    if (infoEl) {
        infoEl.textContent = info;
    }
}

function updateCloudStatus() {
    // Kiểm tra kết nối internet
    isOnline = navigator.onLine;
    
    if (isOnline) {
        updateStatus('Đang kết nối...', 'online');
    } else {
        updateStatus('Không có kết nối internet', 'offline');
    }
}

function updateShareLink(projectId) {
    const shareUrl = `${window.location.origin}${window.location.pathname}?project=${projectId}`;
    document.getElementById('shareLinkText').textContent = shareUrl;
}

function showShareLink() {
    if (!currentProjectId) {
        alert('Vui lòng lưu dữ liệu lên cloud trước để tạo link chia sẻ!');
        return;
    }
    
    updateShareLink(currentProjectId);
    document.getElementById('shareLinkContainer').style.display = 'block';
}

function hideShareLink() {
    document.getElementById('shareLinkContainer').style.display = 'none';
}

function copyShareLink() {
    const shareUrl = document.getElementById('shareLinkText').textContent;
    navigator.clipboard.writeText(shareUrl).then(() => {
        alert('Đã copy link chia sẻ vào clipboard!');
    });
}

async function autoSave() {
    if (currentProjectId && isOnline) {
        await saveToCloud();
    }
}

async function checkForUpdates() {
    if (currentProjectId && isOnline) {
        await loadFromCloud(currentProjectId);
    }
}

function showLoading(message) {
    document.getElementById('loadingMessage').textContent = message;
    document.getElementById('loadingOverlay').style.display = 'flex';
}

function hideLoading() {
    document.getElementById('loadingOverlay').style.display = 'none';
}

function showSuccess(message) {
    alert('✅ ' + message);
}

function showError(message) {
    alert('❌ ' + message);
}

function resetForm() {
    if (confirm('Bạn có chắc muốn xóa tất cả dữ liệu hiện tại?')) {
        document.querySelectorAll('input, textarea, select').forEach(element => {
            if (element.type === 'checkbox') {
                element.checked = false;
            } else if (element.type === 'radio') {
                element.checked = false;
            } else if (element.type === 'date') {
                element.value = new Date().toISOString().split('T')[0];
            } else {
                element.value = '';
            }
            element.dispatchEvent(new Event('input'));
        });
        updateStatus('Đã xóa dữ liệu cục bộ', 'offline');
    }
}

function exportToPDF() {
    // Giữ nguyên chức năng export PDF từ code gốc
    alert('Chức năng xuất PDF (giữ nguyên từ code cũ)');
}

function printForm() {
    window.print();
}

// Lắng nghe sự kiện online/offline
window.addEventListener('online', updateCloudStatus);
window.addEventListener('offline', updateCloudStatus);

// Lắng nghe trước khi đóng trang
window.addEventListener('beforeunload', function(e) {
    updateStatus('Đang thoát...', 'syncing');
});

// ========== HƯỚNG DẪN SỬ DỤNG ==========
console.log(`
=== HƯỚNG DẪN SỬ DỤNG NHANH ===

1. CÁCH DÙNG ĐƠN GIẢN:
   - Người A: Mở file → Điền form → Click "Lưu lên Cloud" → Click "Chia sẻ" → Copy link
   - Người B: Mở link từ A → Tự động có dữ liệu → Cùng điền
   - Tự động đồng bộ mỗi 30 giây

2. KHÔNG CẦN CẤU HÌNH:
   - Mặc định dùng localStorage + URL sharing
   - Link chứa toàn bộ dữ liệu

3. TÍNH NĂNG:
   - Đồng bộ đa người dùng
   - Chia sẻ 1 link
   - Tự động lưu
   - Giữ nguyên PDF/Print/Signature
`);
    </script>
</body>
</html>